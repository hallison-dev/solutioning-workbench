/* Typography & Base */
body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
html { scroll-behavior: smooth; }
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

/* Components */
.badge { display: inline-flex; align-items: center; padding: 0.125rem 0.5rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; }
.badge-blue { background-color: #eff6ff; color: #1d4ed8; border: 1px solid #dbeafe; }
.badge-amber { background-color: #fffbeb; color: #b45309; border: 1px solid #fcd34d; }
.badge-green { background-color: #d1fae5; color: #047857; border: 1px solid #a7f3d0; }
.badge-purple { background-color: #f3e8ff; color: #7e22ce; border: 1px solid #d8b4fe; }
.badge-red { background-color: #fef2f2; color: #b91c1c; border: 1px solid #fecaca; }
.badge-indigo { background-color: #e0e7ff; color: #4338ca; border: 1px solid #c7d2fe; }
.badge-slate { background-color: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; }
.badge-emerald { background-color: #ecfdf5; color: #047857; border: 1px solid #a7f3d0; }

/* Row ID Badge */
.row-id-badge { font-size: 0.65rem; font-family: 'Courier New', monospace; background: #f8fafc; color: #475569; padding: 1px 4px; border-radius: 3px; display: inline-block; border: 1px solid #e2e8f0; }

/* Navigation & Layout Transitions */
aside { transition: width 0.3s ease, opacity 0.3s ease; overflow: hidden; }
aside.collapsed { width: 0 !important; opacity: 0; padding: 0 !important; }

.nav-item.active { background-color: #1e293b; border-left: 4px solid #3b82f6; color: white; }
.nav-item { border-left: 4px solid transparent; color: #94a3b8; }
.tab-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }
.tab-btn { background-color: white; color: #64748b; border: 1px solid #cbd5e1; }

/* Status badges */
.status-badge { display: inline-block; padding: 2px 6px; border-radius: 4px; font-weight: 700; text-transform: lowercase; font-size: 0.7rem; cursor: pointer; user-select: none; border-width: 1px; }
.status-badge.mapped { background: #dcfce7; color: #166534; border-color: #86efac; }
.status-badge.pending { background: #fff7ed; color: #9a3412; border-color: #fdba74; }
.status-badge.gap { background: #fef2f2; color: #991b1b; border-color: #fca5a5; }

/* Category tag */
.tag-badge { display: inline-block; margin-left: 8px; padding: 2px 8px; border-radius: 9999px; background: #f1f5f9; color: #0f172a; font-size: 0.7rem; font-weight: 600; }
.category-select { font-size: 0.7rem; padding: 3px 6px; border: 1px solid #e2e8f0; border-radius: 6px; background: white; }

/* Toast */
#toast-container { position: fixed; right: 24px; bottom: 24px; z-index: 99999; display: flex; flex-direction: column; gap: 8px; }
.toast { min-width: 220px; padding: 10px 14px; border-radius: 8px; color: white; font-weight: 600; box-shadow: 0 6px 18px rgba(2,6,23,0.2); opacity: 0; transform: translateY(8px); transition: all 220ms ease; }
.toast.show { opacity: 1; transform: translateY(0); }
.toast.success { background: #059669; }
.toast.info { background: #2563eb; }
.toast.warn { background: #d97706; }
.toast.error { background: #b91c1c; }

/* Story Feed */
.feed-item { position: relative; padding-left: 1.5rem; padding-bottom: 1.5rem; border-left: 2px solid #e2e8f0; transition: all 0.3s ease; opacity: 0.5; cursor: pointer; }
.feed-item.active { opacity: 1; border-left-color: #3b82f6; }
.feed-item:last-child { border-left-color: transparent; }
.feed-dot { position: absolute; left: -7px; top: 0; width: 12px; height: 12px; border-radius: 50%; background-color: #cbd5e1; transition: all 0.3s ease; }
.feed-item.active .feed-dot { background-color: #3b82f6; transform: scale(1.2); box-shadow: 0 0 0 4px #dbeafe; }

/* Feed Hover Modal */
.feed-modal { display: none; position: absolute; right: 100%; top: 0; width: 280px; margin-right: 20px; background: white; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 1rem; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); z-index: 9999; text-align: left; pointer-events: none; }
.feed-modal::after { content: ''; position: absolute; right: -6px; top: 12px; width: 12px; height: 12px; background: white; transform: rotate(45deg); border-right: 1px solid #e2e8f0; border-top: 1px solid #e2e8f0; }
.feed-container.show-modals .feed-item:hover .feed-modal { display: block; animation: fadeIn 0.2s ease-in-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateX(10px); } to { opacity: 1; transform: translateX(0); } }

/* Question Builder */
.question-row { transition: all 0.3s ease; }
.question-row.confirmed { background-color: #f0fdf4; border-color: #bbf7d0; }
.question-row.confirmed .q-text { color: #15803d; text-decoration: line-through; text-decoration-color: #86efac; }
.answer-box { display: none; }
.answer-box.visible { display: block; animation: slideDown 0.2s ease-out; }
@keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

/* Interactive Hints */
.hint-box { display: none; }
.hint-trigger:hover + .hint-box { display: block; }

/* Spec Uploader Styles */
.uploader-modal { position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center; }
.uploader-modal.hidden { display: none; }
.row-item { cursor: grab; }
.row-item:active { cursor: grabbing; }
.drag-zone { transition: all 0.2s ease; }
.drag-zone.drag-over { background-color: #eff6ff; border-color: #3b82f6; }

/* Master Spec */
.spec-key { max-width: 420px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; display: inline-block; vertical-align: middle; font-weight: 600; }
.spec-key:hover { cursor: help; }
.spec-key.wrap { white-space: normal; word-break: break-word; max-width: none; }
/* master spec search & attach widgets */
.master-search { width: 100%; max-width: 480px; padding: 8px 10px; border: 1px solid #e6eef8; border-radius: 8px; }
.attach-widget { position: relative; display: inline-block; }
.attach-input { width: 260px; padding: 6px 8px; border: 1px solid #e6eef8; border-radius: 6px; }
.attach-list { position: absolute; top: 36px; left: 0; right: 0; max-height: 180px; overflow-y: auto; background: white; border: 1px solid #e6eef8; box-shadow: 0 8px 18px rgba(2,6,23,0.06); z-index: 60; }
.attach-item { padding: 6px 8px; font-size: 13px; cursor: pointer; }
.attach-item:hover { background: #f1f5f9; }
.spec-action { margin-left: 8px; font-size: 12px; color: #2563eb; cursor: pointer; }
.unassign-mark { background: #fff7f5; border-color: #fecaca !important; } .unassign-mark td { color: #9f1239; }

/* Autocomplete Styles */
.autocomplete-wrapper { position: relative; width: 100%; }
.autocomplete-list { position: absolute; top: 100%; left: 0; right: 0; max-height: 220px; overflow-y: auto; background: white; border: 1px solid #cbd5e1; border-radius: 0 0 6px 6px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); z-index: 50; display: none; }
.autocomplete-item { padding: 8px 12px; font-size: 0.8rem; cursor: pointer; border-bottom: 1px solid #f1f5f9; }
.autocomplete-item:last-child { border-bottom: none; }
.autocomplete-item:hover { background-color: #eff6ff; color: #1d4ed8; }
.autocomplete-item strong { color: #1e40af; font-family: 'Courier New', monospace; font-weight: bold; }
.autocomplete-desc { display: block; font-size: 0.7rem; color: #64748b; margin-top: 2px; }

/* Highlight Flash Animation */
@keyframes highlight-row { 0% { background: #fef9c3; } 100% { background: transparent; } }
.highlight-flash { animation: highlight-row 2s ease-out; }

/* Toggle Mode Styles */
.mode-toggle-btn { transition: all 0.3s; }

/* Visualizer */
.check-face { background-image: radial-gradient(#e2e8f0 1px, transparent 1px); background-size: 10px 10px; font-family: 'Georgia', serif; }
.check-field { position: relative; cursor: help; border: 1px dashed transparent; transition: all 0.2s; }
.check-field:hover { border-color: #3b82f6; background-color: rgba(59, 130, 246, 0.1); }
.check-field::after { content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); background-color: #1e293b; color: #fff; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; white-space: nowrap; opacity: 0; pointer-events: none; transition: opacity 0.2s; z-index: 50; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
.check-field:hover::after { opacity: 1; bottom: 110%; }

/* Toggle Buttons for Sidebars */
.sidebar-toggle { position: fixed; z-index: 40; padding: 6px; background: white; border: 1px solid #e2e8f0; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); cursor: pointer; transition: all 0.2s; }
.sidebar-toggle:hover { background: #f1f5f9; }

/* SPREADSHEET STYLES */
.spreadsheet-container { overflow-x: auto; border: 1px solid #cbd5e1; border-radius: 6px; background: white; max-height: 600px; }
.spreadsheet-table { width: 100%; border-collapse: collapse; font-size: 0.75rem; table-layout: fixed; } 
.spreadsheet-table th { background: #f1f5f9; border-bottom: 2px solid #cbd5e1; padding: 4px 8px; text-align: left; font-weight: 700; color: #0f172a; position: sticky; top: 0; z-index: 10; border-right: 1px solid #e2e8f0; height: 32px; user-select: none; position: relative; }
.spreadsheet-table td { padding: 4px 8px; border-bottom: 1px solid #e2e8f0; border-right: 1px solid #e2e8f0; color: #0f172a; font-family: 'Inter', sans-serif; vertical-align: middle; white-space: normal; word-break: break-word; line-height: 1.3; }
.spreadsheet-table tr:hover { background-color: #f8fafc; }

/* Row Tint States */
.row-unresolved { background-color: #fef2f2 !important; } /* Red Tint */
.row-resolved { background-color: #f0fdf4 !important; } /* Green Tint */
/* Ensure hover still works slightly */
.row-unresolved:hover { background-color: #fee2e2 !important; }
.row-resolved:hover { background-color: #dcfce7 !important; }

.spreadsheet-table td input { padding: 2px 4px; font-size: 0.75rem; color: #0f172a; }

/* Resizer Handle */
.resizer { position: absolute; top: 0; right: 0; width: 5px; cursor: col-resize; user-select: none; height: 100%; z-index: 20; touch-action: none; }
.resizer:hover, .resizing { background-color: #3b82f6; opacity: 1; }

/* Action Column & Dropdown */
.col-action-header { background: #f8fafc; text-align: center; position: relative; z-index: 10; }
.action-container { display: flex; gap: 4px; align-items: center; justify-content: center; }

.action-dropdown-wrapper { position: relative; }
.action-dropdown-btn { font-size: 0.65rem; padding: 3px 6px; background: white; border: 1px solid #cbd5e1; border-radius: 4px; color: #334155; cursor: pointer; display: flex; align-items: center; gap: 3px; }
.action-dropdown-btn:hover { background: #f1f5f9; border-color: #94a3b8; }
.action-dropdown-menu { position: absolute; top: 100%; left: 0; background: white; border: 1px solid #cbd5e1; border-radius: 4px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 120px; z-index: 30; text-align: left; display: none; }
.action-dropdown-menu button { display: block; width: 100%; text-align: left; padding: 6px 8px; font-size: 0.7rem; color: #475569; }
.action-dropdown-menu button:hover { background: #f8fafc; color: #0f172a; }
.action-dropdown-wrapper.open .action-dropdown-menu { display: block; }

.action-question-btn { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; border-radius: 4px; color: #94a3b8; font-weight: bold; font-size: 0.7rem; cursor: pointer; border: 1px solid transparent; }
.action-question-btn:hover { background: #f1f5f9; color: #3b82f6; border-color: #e2e8f0; }
.action-question-btn.has-q-unresolved { color: #ef4444; background: #fef2f2; border-color: #fecaca; }
.action-question-btn.has-q-resolved { color: #10b981; background: #ecfdf5; border-color: #a7f3d0; }

.col-delete-btn { margin-left: 6px; color: #94a3b8; cursor: pointer; transition: color 0.2s; font-size: 10px; }
.spreadsheet-table th:hover .col-delete-btn { color: #ef4444; }
.map-radio { margin-right: 6px; cursor: pointer; accent-color: #2563eb; vertical-align: middle; width: 10px; height: 10px; }